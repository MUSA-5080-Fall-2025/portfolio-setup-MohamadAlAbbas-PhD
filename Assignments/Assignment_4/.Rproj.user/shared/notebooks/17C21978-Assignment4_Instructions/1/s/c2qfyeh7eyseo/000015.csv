"0","#| label: NN Abandoned"
"0","#| message: false"
"0",""
"0","# Get coordinates"
"0","fishnet_coords <- st_coordinates(st_centroid(fishnet))"
"0","abandoned_coords <- st_coordinates(abandoned_houses)"
"0",""
"0","# Calculate k nearest neighbors and distances"
"0","nn_result <- get.knnx(abandoned_coords, fishnet_coords, k = 3)"
"0",""
"0","# Add to fishnet"
"0","fishnet <- fishnet %>%"
"0","  mutate("
"0","    abandoned_houses.nn = rowMeans(nn_result$nn.dist)"
"0","  )"
"0",""
"0","# Summary of mean distance to 3 nearest abandoned houses"
"0","nn_summary <- summary(fishnet$abandoned_houses.nn)"
"0",""
"0","# Order of numeric stats as in summary()"
"0","stat_names <- c(""Min."", ""1st Qu."", ""Median"", ""Mean"", ""3rd Qu."", ""Max."")"
"0",""
"0","# Extract, round, and format to 2 decimal places"
"0","nn_vals <- nn_summary[stat_names]"
"0","nn_vals <- as.numeric(nn_vals)"
"0","nn_vals <- round(nn_vals, 2)"
"0","nn_vals <- sprintf(""%.2f"", nn_vals)"
"0",""
"0","nn_tbl <- tibble::tibble("
"0","  Statistic = c(""Min"", ""1st Quartile"", ""Median"", ""Mean"", ""3rd Quartile"", ""Max""),"
"0","  `Distance (m)` = nn_vals"
"0",")"
"0",""
"0","knitr::kable("
"0","  nn_tbl,"
"0","  caption   = ""Summary of Mean Distance to 3 Nearest Vacant/Abandoned Houses (meters)"","
"0","  col.names = c(""Statistic"", ""Distance (m)""),"
"0","  align     = c(""l"",""r""),"
"0","  booktabs  = TRUE"
"0",") |>"
"0","  kableExtra::kable_styling("
"0","    full_width = FALSE,"
"0","    bootstrap_options = c(""striped"",""hover"",""condensed"")"
"0","  )"
