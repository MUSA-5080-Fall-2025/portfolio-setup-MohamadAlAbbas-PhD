"0","#| label: logo-cv-negbin-metrics"
"0","#| message: false"
"0","#| warning: false"
"0",""
"0","# ---- Calculate & Report Error Metrics (uses `cv_preds`) ----"
"0",""
"0","# Per-district metrics"
"0","cv_results <- cv_preds %>%"
"0","  dplyr::group_by(fold, test_district) %>%"
"0","  dplyr::summarise("
"0","    n_test      = dplyr::n(),"
"0","    mae_negbin  = mean(abs(y - pred_negbin)),"
"0","    rmse_negbin = sqrt(mean((y - pred_negbin)^2)),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","# Overall means"
"0","nb_mean_mae  <- mean(cv_results$mae_negbin)"
"0","nb_mean_rmse <- mean(cv_results$rmse_negbin)"
"0",""
"0","overall_row <- tibble::tibble("
"0","  fold         = NA_integer_,"
"0","  test_district= ""Overall mean"","
"0","  n_test       = sum(cv_results$n_test),"
"0","  mae_negbin   = nb_mean_mae,"
"0","  rmse_negbin  = nb_mean_rmse"
"0",")"
"0",""
"0","cv_table <- dplyr::bind_rows("
"0","  overall_row,"
"0","  cv_results %>% dplyr::arrange(dplyr::desc(mae_negbin))"
"0",")"
"0",""
"0","knitr::kable("
"0","  cv_table,"
"0","  digits  = 3,"
"0","  caption = ""LOGO CV Results by District and Overall â€” Negative Binomial (DV = Burglaries)"","
"0","  col.names = c(""Fold"", ""District"", ""N test"", ""MAE (NB)"", ""RMSE (NB)""),"
"0","  booktabs = TRUE"
"0",") %>%"
"0","  kableExtra::kable_styling("
"0","    bootstrap_options = c(""striped"",""hover""),"
"0","    full_width = FALSE"
"0","  )"
