"0","#| label: Aggregate Abandoned/Vacant Houses"
"0",""
"0","# Spatial join: which cell contains each burglary?"
"0","# Aggregate BURGLARIES to the 500m grid"
"0","burg_fishnet <- st_join(burglaries, fishnet, join = st_within) %>%"
"0","  st_drop_geometry() %>%"
"0","  group_by(uniqueID) %>%"
"0","  summarize(burglaries = n(), .groups = ""drop"")"
"0",""
"0","# Spatial join: which cell contains each abandoned/vacant house?"
"0","# Aggregate abandoned/vacant house to the 500m grid"
"0",""
"0","houses_fishnet <- st_join(abandoned_houses, fishnet, join = st_within) %>%"
"0","  st_drop_geometry() %>%"
"0","  group_by(uniqueID) %>%"
"0","  summarize(abandoned_houses = n())"
"0",""
"0","# Join back to fishnet (cells with 0 burglaries will be NA)"
"0","fishnet <- fishnet %>%"
"0","  left_join(burg_fishnet, by = ""uniqueID"") %>%"
"0","  mutate(burglaries = tidyr::replace_na(burglaries, 0))"
"0",""
"0","# Join back to fishnet (cells with 0 abandoned/vacant house will be NA)"
"0","fishnet <- fishnet %>%"
"0","  left_join(houses_fishnet, by = ""uniqueID"") %>%"
"0","  mutate(abandoned_houses = replace_na(abandoned_houses, 0))"
"0",""
"0","# Basic summary stats"
"0","abandoned_summary <- summary(fishnet$abandoned_houses)"
"0",""
"0","# Zero-count cells"
"0","zero_count <- sum(fishnet$abandoned_houses == 0)"
"0","zero_pct   <- 100 * zero_count / nrow(fishnet)"
"0",""
"0","# Order of numeric stats as in summary()"
"0","stat_names <- c(""Min."", ""1st Qu."", ""Median"", ""Mean"", ""3rd Qu."", ""Max."")"
"0",""
"0","# Extract, round, and format to 2 decimal places"
"0","numeric_vals <- abandoned_summary[stat_names]"
"0","numeric_vals <- as.numeric(numeric_vals)"
"0","numeric_vals <- round(numeric_vals, 2)"
"0","numeric_vals <- sprintf(""%.2f"", numeric_vals)"
"0",""
"0","summary_tbl <- tibble::tibble("
"0","  Statistic = c("
"0","    ""Min"","
"0","    ""1st Quartile"","
"0","    ""Median"","
"0","    ""Mean"","
"0","    ""3rd Quartile"","
"0","    ""Max"","
"0","    ""Cells with zero abandoned houses"""
"0","  ),"
"0","  Value = c("
"0","    numeric_vals,"
"0","    paste0("
"0","      scales::comma(zero_count), "" / "", "
"0","      scales::comma(nrow(fishnet)), "
"0","      "" ("", round(zero_pct, 1), ""%)"""
"0","    )"
"0","  )"
"0",")"
"0",""
"0","knitr::kable("
"0","  summary_tbl,"
"0","  caption   = ""Summary of Vacant/Abandoned House Counts per Grid Cell"","
"0","  col.names = c(""Statistic"", ""Value""),"
"0","  align     = c(""l"",""r""),"
"0","  booktabs  = TRUE"
"0",") |>"
"0","  kableExtra::kable_styling("
"0","    full_width = FALSE,"
"0","    bootstrap_options = c(""striped"",""hover"",""condensed"")"
"0","  )"
