"0","# Define your race/ethnicity variables with descriptive names"
"0",""
"0","race_vars <- c("
"0","  total    = ""B03002_001"","
"0","  white    = ""B03002_003"","
"0","  black    = ""B03002_004"","
"0","  hispanic = ""B03002_012"""
"0",")"
"0",""
"0",""
"0","# Use get_acs() to retrieve tract-level data"
"0","# Hint: You may need to specify county codes in the county parameter"
"0",""
"0","county_codes <- unique(str_sub(county$GEOID, 3, 5))"
"0",""
"0","tract_raw <- get_acs("
"0","  geography = ""tract"","
"0","  state     = my_state,"
"0","  county    = county_codes,"
"0","  survey    = ""acs5"","
"0","  year      = 2022,"
"0","  variables = race_vars,"
"0","  output    = ""wide"""
"0",")"
"0",""
"0",""
"0","# Calculate percentage of each group using mutate()"
"0","# Create percentages for white, Black, and Hispanic populations"
"0",""
"0","tract_percent <- tract_raw %>%"
"0","  mutate("
"0","    county_code  = substr(GEOID, 3, 5),"
"0","    pct_white    = 100 * (whiteE    / totalE),"
"0","    pct_black    = 100 * (blackE    / totalE),"
"0","    pct_hispanic = 100 * (hispanicE / totalE),"
"0","    tract_label  = str_remove(NAME, paste0("", "", my_state)),"
"0","    tract_label  = str_remove(tract_label, "", United States$"")"
"0","  ) %>%"
"0","  left_join("
"0","    county %>%"
"0","      mutate(county_code = substr(GEOID, 3, 5)) %>% #I doubled checked the counts with the census website."
"0","      select(county_code, county_name),"
"0","    by = ""county_code"""
"0","  ) %>%"
"0","  select("
"0","    GEOID, county_name, tract_label,"
"0","    totalE, whiteE, blackE, hispanicE,"
"0","    totalM, whiteM, blackM, hispanicM,"
"0","    pct_white, pct_black, pct_hispanic"
"0","  )"
"0",""
"0",""
"0","# Add readable tract and county name columns using str_extract() or similar"
"0",""
"0","kable("
"0","  tract_percent %>% count(county_name, name = ""Number of Tracts""),"
"0","  caption = ""Tracts Retrieved per Selected County"","
"0","  align = c(""l"", ""c""),"
"0","  col.names = c(""County Names"", ""Number of Tracts"")"
"0",")"
