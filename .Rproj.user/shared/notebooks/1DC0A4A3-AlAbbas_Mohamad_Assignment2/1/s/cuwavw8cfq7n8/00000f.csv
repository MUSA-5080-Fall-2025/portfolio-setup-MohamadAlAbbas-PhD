"0","#| label: Healthcare Challenges"
"0","#| message: false"
"0","#| warning: false"
"0",""
"0","# Create county-level access map"
"0","counties_map <- pa_proj %>%"
"0","  left_join(county_summaries, by = ""COUNTY_NAM"")"
"0",""
"0","# Map: % of vulnerable tracts underserved + hospitals (with shared legend)"
"0","ggplot() +"
"0","  # County polygons colored by % underserved"
"0","  geom_sf("
"0","    data = counties_map,"
"0","    aes(fill = `Percent Underserved (%)`),"
"0","    color = ""white"","
"0","    size  = 0.2"
"0","  ) +"
"0","  # Hospital points added to legend"
"0","  geom_sf("
"0","    data  = hospitals_proj,"
"0","    aes(shape = ""Hospitals""),     # <— adds to legend"
"0","    color = ""darkgreen"","
"0","    size  = 1.5,"
"0","    alpha = 0.8,"
"0","    inherit.aes = FALSE"
"0","  ) +"
"0","  # Continuous viridis fill scale"
"0","  scale_fill_viridis_c("
"0","    name   = ""% of vulnerable tracts underserved"","
"0","    labels = scales::label_number(accuracy = 1, suffix = ""%""),"
"0","    limits = c(0, 100),"
"0","    option = ""plasma"","
"0","    na.value = ""grey90"""
"0","  ) +"
"0","  # Add a manual shape legend for hospitals"
"0","  scale_shape_manual("
"0","    name   = NULL,"
"0","    values = c(""Hospitals"" = 16)  # solid circle"
"0","  ) +"
"0","  # Combine legends neatly (fill first, shape second)"
"0","  guides("
"0","    fill  = guide_colorbar(order = 1, barwidth = 0.7, barheight = 8),"
"0","    shape = guide_legend(order = 2, override.aes = list(size = 3, color = ""darkgreen""))"
"0","  ) +"
"0","  labs("
"0","    title    = ""Healthcare Access Challenges Across Pennsylvania"","
"0","    subtitle = ""% of vulnerable tracts (low-income & elderly) >15 miles from the nearest hospital"","
"0","    caption  = ""Sources: ACS 2018–2022 (tidycensus); PA Counties & Hospitals (course data). Projection: EPSG:3365"""
"0","  ) +"
"0","  coord_sf(datum = NA) +"
"0","  theme_void() +"
"0","  theme("
"0","    legend.position = ""right"","
"0","    legend.title    = element_text(size = 10, face = ""bold""),"
"0","    legend.text     = element_text(size = 9),"
"0","    plot.title      = element_text(face = ""bold"", size = 14),"
"0","    plot.subtitle   = element_text(size = 11),"
"0","    plot.caption    = element_text(size = 9)"
"0","  )"
"0",""
