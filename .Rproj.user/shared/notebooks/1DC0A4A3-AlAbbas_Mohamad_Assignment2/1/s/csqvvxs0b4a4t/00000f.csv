"0","#| label: Underserved Demographics"
"0","#| message: false"
"0","#| warning: false"
"0","#| results: ""hide"" #Remove this to see results of Kable"
"0",""
"0",""
"0","# Spatial join tracts to counties"
"0",""
"0","PA_sjoin <- PA_tracts %>%"
"0","  st_join(pa_proj)"
"0",""
"0","# For each county, compute:"
"0","# Total number of tracts"
"0","# Mean tract area"
"0","# Count of vulnerable and underserved tracts"
"0","# % of vulnerable tracts that are underserved"
"0","# Average distance (mi) to nearest hospital for vulnerable tracts"
"0","# Total elderly population in vulnerable tracts"
"0",""
"0","county_summaries <- PA_sjoin %>%"
"0","  st_drop_geometry() %>%"
"0","  group_by(COUNTY_NAM) %>%"
"0","  summarize("
"0","    `Number of Tracts`                = n(),"
"0","    `Average Tract Area (sq mi)`      = round(mean(AREA_SQ_MI, na.rm = TRUE), 2),"
"0","    `Vulnerable Tracts`               = sum(vulnerable, na.rm = TRUE),"
"0","    `Underserved Tracts`              = sum(underserved, na.rm = TRUE),"
"0","    `Percent Underserved (%)`         = ifelse("
"0","      sum(vulnerable, na.rm = TRUE) > 0,"
"0","      round(sum(underserved, na.rm = TRUE) / sum(vulnerable, na.rm = TRUE) * 100, 2),"
"0","      0"
"0","    ),"
"0","    `Avg Dist (mi) - Vulnerable`      = ifelse("
"0","      sum(vulnerable, na.rm = TRUE) > 0,"
"0","      round(mean(nearest_hosp_miles[vulnerable], na.rm = TRUE), 2),"
"0","      NA_real_"
"0","    ),"
"0","    `Total Vulnerable Pop (65+)`      = ifelse("
"0","      sum(vulnerable, na.rm = TRUE) > 0,"
"0","      sum(pop65plus[vulnerable], na.rm = TRUE),"
"0","      0"
"0","    )"
"0","  )"
"0",""
"0","# Identify top 5 counties by % underserved"
"0",""
"0","top5_underserved <- county_summaries %>%"
"0","  arrange(desc(`Percent Underserved (%)`),desc(`Total Vulnerable Pop (65+)`)) %>%"
"0","  slice_head(n = 5)"
"0",""
"0",""
"0","knitr::kable("
"0","  top5_underserved,"
"0","  caption = ""Top 5 Counties with Highest Percentage of Underserved Vulnerable Tracts"","
"0","  align = ""c"""
"0",")"
