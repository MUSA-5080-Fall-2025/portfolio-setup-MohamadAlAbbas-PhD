"0",""
"0",""
"0","# Thresholds: top quartile minority share, bottom quartile coverage"
"0","thr_minority_tr <- quantile(tracts_deficit$pct_minority,     0.75, na.rm = TRUE)"
"0","thr_cover_tr    <- quantile(tracts_deficit$pct_pop_covered, 0.25, na.rm = TRUE)"
"0",""
"0","tracts_equity_tr <- tracts_deficit %>%"
"0","  mutate("
"0","    high_minority_tr = pct_minority     >= thr_minority_tr,"
"0","    low_cover_tr     = pct_pop_covered  <= thr_cover_tr,"
"0","    flag_both_tr     = high_minority_tr & low_cover_tr"
"0","  )"
"0",""
"0","ggplot() +"
"0","  # Fill by % of tract population covered (easier to interpret than the index)"
"0","  geom_sf("
"0","    data  = tracts_equity_tr,"
"0","    aes(fill = pct_pop_covered),"
"0","    color = NA"
"0","  ) +"
"0","  # Red outline for tracts meeting BOTH: high-minority AND low-coverage"
"0","  geom_sf("
"0","    data      = dplyr::filter(tracts_equity_tr, flag_both_tr),"
"0","    fill      = NA,"
"0","    color     = ""cyan"","
"0","    linewidth = 0.35"
"0","  ) +"
"0","  geom_sf("
"0","    data  = pa_proj,"
"0","    fill  = NA, color = ""white"", linewidth = 0.25"
"0","  ) +"
"0","  geom_sf("
"0","    data  = stations_proj,"
"0","    aes(shape = ""Fire/EMS stations""),"
"0","    color = ""darkgreen"", size = 0.9, alpha = 0.85, inherit.aes = FALSE"
"0","  ) +"
"0","  scale_fill_viridis_c("
"0","    name   = ""% of tract population within 2 miles"","
"0","    labels = label_number(accuracy = 1, suffix = ""%""),"
"0","    option = ""plasma"","
"0","    na.value = ""grey90"""
"0","  ) +"
"0","  scale_shape_manual(name = NULL, values = c(""Fire/EMS stations"" = 16)) +"
"0","  guides("
"0","    fill  = guide_colorbar(order = 1, barheight = 8),"
"0","    shape = guide_legend(order = 2, override.aes = list(size = 2.2, color = ""darkgreen""))"
"0","  ) +"
"0","  labs("
"0","    title    = ""Coverage Equity (Tract-Level): Fire/EMS Access in Pennsylvania"","
"0","    subtitle = paste0("
"0","      ""Cyan outline = top 25% minority share (≥ "", round(thr_minority_tr, 1),"
"0","      ""%) AND bottom 25% coverage (≤ "", round(thr_cover_tr, 1), ""%)"""
"0","    ),"
"0","    caption  = ""Minority share: ACS B03002 (2018–2022). Coverage: 2-mile buffers, area-weighted to tracts."""
"0","  ) +"
"0","  coord_sf(datum = NA) +"
"0","  theme_void() +"
"0","  theme("
"0","    legend.position = ""right"","
"0","    plot.title      = element_text(face = ""bold"", size = 14),"
"0","    plot.subtitle   = element_text(size = 11),"
"0","    plot.caption    = element_text(size = 9)"
"0","  )"
