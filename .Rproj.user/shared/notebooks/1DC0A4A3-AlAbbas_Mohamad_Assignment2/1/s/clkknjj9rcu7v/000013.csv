"0",""
"0","# Z-score standardization and the “deficiency index”"
"0","# --------------------------------------------------"
"0","# We compare two quantities on different scales:"
"0","#   (1) pop_density_i          = population per square mile in tract i"
"0","#   (2) pct_pop_covered_i      = % of tract i’s population within 2 miles of a station"
"0","#"
"0","# To make them comparable, we standardize each with a z-score:"
"0","#   z(x_i) = (x_i − mean(x)) / sd(x), computed across all Pennsylvania tracts."
"0","# This rescales both variables to unitless, mean-0, sd-1 measures so differences"
"0","# reflect relative position within the statewide distribution (not raw units)."
"0","#"
"0","# Deficiency index (higher = denser but under-covered):"
"0","#   deficiency_i = z(pop_density_i) − z(pct_pop_covered_i)"
"0","# Interpretation:"
"0","#   - Positive : tract is relatively dense given its relatively low coverage"
"0","#                  (potential service gap / higher priority)."
"0","#   - 0        : density and coverage are in balance relative to peers."
"0","#   - Negative : tract is relatively sparse and/or relatively well covered."
"0",""
"0","tracts_deficit <- tracts_cov %>%"
"0","  mutate("
"0","    pct_pop_covered = if_else(pop > 0, (pop_cov / pop) * 100, NA_real_),"
"0","    z_density       = as.numeric(scale(pop_density)),"
"0","    z_coverage      = as.numeric(scale(pct_pop_covered)),"
"0","    deficit_index   = z_density - z_coverage  # higher = dense but poorly covered"
"0","  )"
"0",""
"0","ggplot() +"
"0","  geom_sf("
"0","    data  = tracts_deficit,"
"0","    aes(fill = deficit_index),"
"0","    color = NA"
"0","  ) +"
"0","  geom_sf("
"0","    data  = pa_proj,"
"0","    fill  = NA, color = ""white"", linewidth = 0.25"
"0","  ) +"
"0","  geom_sf("
"0","    data  = stations_proj,"
"0","    aes(shape = ""Fire/EMS stations""),"
"0","    color = ""darkgreen"", size = 0.9, alpha = 0.85, inherit.aes = FALSE"
"0","  ) +"
"0","  scale_fill_gradient2("
"0","    name     = ""Coverage Deficit Index\n(+ = dense but low coverage)"","
"0","    low      = ""#2b83ba"", mid = ""white"", high = ""#d7191c"","
"0","    midpoint = 0"
"0","  ) +"
"0","  scale_shape_manual(name = NULL, values = c(""Fire/EMS stations"" = 16)) +"
"0","  guides("
"0","    fill  = guide_colorbar(order = 1, barheight = 8),"
"0","    shape = guide_legend(order = 2, override.aes = list(size = 2.2, color = ""darkgreen""))"
"0","  ) +"
"0","  labs("
"0","    title    = ""Coverage vs. Density (Tract-Level): Potential Fire/EMS Service Gaps"","
"0","    subtitle = ""Index = z(population density) − z(% of tract population within 2 miles of a station)"","
"0","    caption  = ""Buffers ≈ 2 miles (EPSG:3365). Coverage apportioned by tract area overlap."""
"0","  ) +"
"0","  coord_sf(datum = NA) +"
"0","  theme_void() +"
"0","  theme("
"0","    legend.position = ""right"","
"0","    plot.title      = element_text(face = ""bold"", size = 14),"
"0","    plot.subtitle   = element_text(size = 11),"
"0","    plot.caption    = element_text(size = 9)"
"0","  )"
