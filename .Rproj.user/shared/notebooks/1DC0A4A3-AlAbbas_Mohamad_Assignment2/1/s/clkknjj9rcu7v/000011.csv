"0",""
"0","# Count stations per county for context (optional columns if you want to show later)"
"0","stns_in_county <- st_join(stations_proj, pa_proj, join = st_within)"
"0","county_station_counts <- stns_in_county %>%"
"0","  st_drop_geometry() %>%"
"0","  count(COUNTY_NAM, name = ""Stations"")"
"0",""
"0","# Aggregate tract metrics to counties"
"0","t2c <- st_join(tracts_equity, pa_proj) %>% st_drop_geometry()"
"0",""
"0","county_equity <- t2c %>%"
"0","  group_by(COUNTY_NAM) %>%"
"0","  summarise("
"0","    Total_Population             = sum(pop, na.rm = TRUE),"
"0","    Covered_Population           = sum(pop_cov, na.rm = TRUE),"
"0","    Uncovered_Population         = sum(pop_uncovered, na.rm = TRUE),"
"0","    Minority_Population          = sum(minority, na.rm = TRUE),"
"0","    Estimated_Uncovered_Minority = sum(est_uncovered_minor, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  left_join(county_station_counts, by = ""COUNTY_NAM"") %>%"
"0","  mutate("
"0","    `Percent Covered` = if_else(Total_Population > 0,"
"0","                                Covered_Population / Total_Population * 100, NA_real_)"
"0","  )"
"0",""
"0","# extracting top ten counties with high unocvered minority levels. "
"0","equity_top_abs <- county_equity %>%"
"0","  arrange(desc(Estimated_Uncovered_Minority)) %>%"
"0","  slice_head(n = 10) %>%"
"0","  select("
"0","    County                          = COUNTY_NAM,"
"0","    `Estimated Minority Uncovered`  = Estimated_Uncovered_Minority,"
"0","    `Total Uncovered`               = Uncovered_Population,"
"0","    `Percent Covered`               = `Percent Covered`,"
"0","    Stations"
"0","  ) %>%"
"0","  mutate("
"0","    across(c(`Estimated Minority Uncovered`, `Total Uncovered`, Stations), comma),"
"0","    across(c(`Percent Covered`), ~round(.x, 1))"
"0","  )"
"0",""
"0","knitr::kable("
"0","  equity_top_abs,"
"0","  caption = ""Equity Table: Top 10 Counties by Estimated Minority Uncovered Population"","
"0","  align   = ""c"""
"0",")"
