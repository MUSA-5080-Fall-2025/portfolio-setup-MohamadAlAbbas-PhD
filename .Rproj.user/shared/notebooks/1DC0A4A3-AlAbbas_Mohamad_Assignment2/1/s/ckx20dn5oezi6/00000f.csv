"0","#| label: Detecting Underserved Areas"
"0","#| message: false"
"0","#| warning: false"
"0",""
"0","# A tract is classified as underserved if it meets BOTH conditions:"
"0","#   (1) It is already marked as ""vulnerable"" (low income + high elderly share)"
"0","#   (2) It lies more than 15 miles from the nearest hospital"
"0","#"
"0","# This combined condition identifies tracts that are both socioeconomically"
"0","# and spatially disadvantaged in terms of healthcare access."
"0",""
"0","PA_tracts <- PA_tracts %>%"
"0","  mutate("
"0","    underserved = vulnerable & nearest_hosp_miles > 15"
"0","  )"
"0",""
"0","# `total_vulnerable`: total number of tracts identified as vulnerable"
"0","# `total_underserved`: number of vulnerable tracts that are also >15 miles away"
"0","# `pct_underserved`: share (%) of vulnerable tracts that are underserved"
"0",""
"0","underserved_summary <- PA_tracts %>%"
"0","  st_drop_geometry() %>%"
"0","  summarize("
"0","    `Total Vulnerable Tracts`  = sum(vulnerable, na.rm = TRUE),"
"0","    `Total Underserved Tracts` = sum(underserved, na.rm = TRUE),"
"0","    `Percent Underserved (%)`  = round(sum(underserved, na.rm = TRUE) /"
"0","                                       sum(vulnerable, na.rm = TRUE) * 100, 2)"
"0","  )"
"0",""
"0","knitr::kable("
"0","  underserved_summary,"
"0","  caption = ""Underserved Tracts Summary (Vulnerable + >15 miles from Hospital)"","
"0","  align = c(""c"", ""c"", ""c"")"
"0",")"
